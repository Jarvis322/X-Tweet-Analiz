<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>X Analizör ULTRA v5.5 - Matematiksel Final</title>
    <style>
        :root {
            --bg: #000; --card: #16181c; --border: #2f3336;
            --primary: #1d9bf0; --success: #00ba7c; --danger: #f91880; --warning: #ffd400;
            --glass: rgba(0, 0, 0, 0.7);
        }
        body { background: var(--bg); color: #e7e9ea; font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif; padding: 0; margin:0; }
        
        .main-header {
            position: sticky; top: 0; z-index: 1000;
            background: var(--glass); backdrop-filter: blur(12px);
            border-bottom: 1px solid var(--border); padding: 12px 20px; display: flex; justify-content: center;
        }
        .header-content { width: 100%; max-width: 1200px; display: flex; justify-content: space-between; align-items: center; }
        .brand { display: flex; align-items: center; gap: 12px; }
        .x-logo { width: 28px; height: 28px; fill: white; }
        .brand-text h1 { margin: 0; font-size: 16px; font-weight: 900; }
        .badge-ultra { background: linear-gradient(45deg, #f91880, #1d9bf0); color: white; padding: 2px 6px; border-radius: 4px; font-size: 9px; font-weight: 900; text-transform: uppercase; }
        
        .page-wrapper { display: flex; justify-content: center; padding: 25px 20px; }
        .container { width: 100%; max-width: 1200px; display: grid; grid-template-columns: 1.2fr 0.8fr; gap: 25px; }
        .card { background: var(--card); border: 1px solid var(--border); border-radius: 16px; padding: 20px; margin-bottom: 20px; }
        .header-tools { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; margin-bottom: 20px; }
        label { font-size: 10px; color: #71767b; font-weight: bold; text-transform: uppercase; display: block; margin-bottom: 5px; }
        
        select, input[type="time"] { background: #000; color: #fff; border: 1px solid var(--border); padding: 10px; border-radius: 8px; width: 100%; outline: none; font-size: 13px; }
        textarea { width: 100%; background: transparent; border: none; color: white; font-size: 20px; outline: none; resize: none; min-height: 250px; line-height: 1.4; font-family: inherit; }
        
        .score-display { text-align: center; border-bottom: 1px solid var(--border); padding-bottom: 20px; margin-bottom: 20px; }
        .score-num { font-size: 80px; font-weight: 900; line-height: 1; transition: 0.3s; color: var(--primary); }
        
        .f-item { padding: 10px 15px; border-radius: 10px; margin-bottom: 8px; font-size: 12px; border-left: 4px solid; background: rgba(255,255,255,0.03); }
        .success { border-color: var(--success); } .danger { border-color: var(--danger); } .warning { border-color: var(--warning); }
        
        .metric-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .m-card { background: #1c1f23; padding: 15px; border-radius: 12px; text-align: center; border: 1px solid transparent; }
        .m-val { font-size: 16px; font-weight: bold; display: block; margin-top: 4px; }
        .m-lab { font-size: 9px; color: #71767b; text-transform: uppercase; letter-spacing: 1px; }

        #charShow { margin-left:auto; align-self:center; color:#71767b; font-size:12px; font-family: monospace; }
        @media (max-width: 900px) { .container { grid-template-columns: 1fr; } }
    </style>
</head>
<body>

<header class="main-header">
    <div class="header-content">
        <div class="brand">
            <svg viewBox="0 0 24 24" class="x-logo"><path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z"></path></svg>
            <div class="brand-text">
                <h1>Analizör <span class="badge-ultra">ULTRA</span></h1>
            </div>
        </div>
        <div style="font-size: 11px; color: #71767b;">ALGORİTMA MOTORU v5.5 (FINAL MATH)</div>
    </div>
</header>

<div class="page-wrapper">
    <div class="container">
        <div class="left-col">
            <div class="card">
                <div class="header-tools">
                    <div>
                        <label>Hesap Tipi</label>
                        <select id="acc" onchange="run()">
                            <option value="1">Standart (280 Karakter)</option>
                            <option value="1.8">Mavi Tikli (Premium)</option>
                            <option value="2.5">Altın Tik (Business)</option>
                            <option value="0.5">Shadowban / Yeni</option>
                        </select>
                    </div>
                    <div>
                        <label>Konu Kümesi</label>
                        <select id="cluster" onchange="run()">
                            <option value="1.0">Genel / Karma</option>
                            <option value="1.2">Yazılım / Teknoloji</option>
                            <option value="0.9">Siyaset / Gündem</option>
                            <option value="0.7">Satış / Tanıtım</option>
                        </select>
                    </div>
                    <div>
                        <label>Zamanlama</label>
                        <input type="time" id="postTime" value="20:00" onchange="run()">
                    </div>
                </div>

                <textarea id="txt" placeholder="Neler oluyor?" oninput="run()"></textarea>

                <div style="border-top: 1px solid var(--border); padding-top: 15px; display: flex; gap: 10px;">
                    <button onclick="setMedia('v')" id="btnV" style="background:#1d9bf0; color:white; border:none; padding:8px 18px; border-radius:20px; cursor:pointer; font-weight:bold; font-size:13px;">+ Video</button>
                    <button onclick="setMedia('i')" id="btnI" style="background:#333; color:white; border:none; padding:8px 18px; border-radius:20px; cursor:pointer; font-weight:bold; font-size:13px;">+ Görsel</button>
                    <button onclick="setMedia('n')" style="background:transparent; color:#71767b; border:1px solid #333; padding:8px 18px; border-radius:20px; cursor:pointer; font-size:13px;">Temizle</button>
                    <div id="charShow">0 / 280</div>
                </div>
            </div>
            <div id="feedBox"></div>
        </div>

        <div class="right-col">
            <div class="card">
                <div class="score-display">
                    <div style="font-size:10px; color:#71767b; letter-spacing:2px; font-weight:bold;">VİRAL OLASILIK SKORU</div>
                    <div id="score" class="score-num">0</div>
                    <div id="rank" style="font-weight:bold; margin-top:10px; color:#71767b; font-size:12px;">ANALİZ BEKLENİYOR</div>
                </div>

                <div class="metric-grid">
                    <div class="m-card"><span class="m-lab">Erişim Çarpanı</span><span class="m-val" id="mReach">--</span></div>
                    <div class="m-card"><span class="m-lab">Güven Skoru</span><span class="m-val" id="mTrust">--</span></div>
                    <div class="m-card"><span class="m-lab">Okunma (Dwell)</span><span class="m-val" id="mDwell">0sn</span></div>
                    <div class="m-card"><span class="m-lab">Spam Riski</span><span class="m-val" id="mSpam">%0</span></div>
                </div>
                
                <div style="margin-top: 20px; padding: 15px; background: rgba(29, 155, 240, 0.03); border-radius: 12px; border: 1px solid rgba(255,255,255,0.05);">
                    <p style="font-size: 10px; color: #555; margin: 0; line-height: 1.5;">
                        <b>Matematiksel Not:</b> Bu simülasyonda hesap otoritesi bir "puan tamamlama" aracı değildir. Sadece kaliteli içeriğin çarpan etkisini (reach) belirler. İçerik kötüyse çarpan etkisi minimize edilir.
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    let activeMedia = 'none';
    function setMedia(m) { activeMedia = m; run(); }

    function run() {
        const text = document.getElementById('txt').value;
        const accType = parseFloat(document.getElementById('acc').value);
        const cluster = parseFloat(document.getElementById('cluster').value);
        const postTime = document.getElementById('postTime').value;
        const feedBox = document.getElementById('feedBox');
        const charShow = document.getElementById('charShow');
        
        // 1. DİNAMİK LİMİT KONTROLÜ
        let limit = (accType >= 1.8) ? 25000 : 280;
        charShow.textContent = text.length + ' / ' + limit;
        charShow.style.color = (text.length > limit) ? 'var(--danger)' : '#71767b';

        if(!text && activeMedia === 'none') {
            document.getElementById('score').textContent = "0";
            return;
        }

        // 2. MATEMATİKSEL MODELLEME (0-100 BAZLI)
        let baseQuality = 20; // Baz Puan
        let penalties = 1.0;  // Ceza Çarpanı
        let dwellTime = 0;
        let spamRisk = 0;
        let feeds = [];

        // Karakter Sınırı Kontrolü (Giyotin Kuralı)
        if (text.length > limit) {
            baseQuality = 0;
            penalties = 0;
            feeds.push({t:'danger', m: `ERİŞİM ENGELLENDİ: Karakter sınırı (${limit}) aşıldı. Standart hesaplar uzun içerik paylaşamaz.`});
        } else {
            // Medya Katkısı (Toplamsal)
            if(activeMedia === 'v') { baseQuality += 25; dwellTime += 40; feeds.push({t:'success', m:'Video Boost: Algoritma tüketim süresini ödüllendirir (+25).'}); }
            else if(activeMedia === 'i') { baseQuality += 10; dwellTime += 10; feeds.push({t:'success', m:'Görsel: İlgi çekme olasılığı artırıldı (+10).'}); }

            // Zamanlama (Toplamsal)
            const hour = parseInt(postTime.split(':')[0]);
            if (hour >= 18 && hour <= 22) { baseQuality += 15; feeds.push({t:'success', m:'Altın Saatler: Maksimum kullanıcı trafiği (+15).'}); }
            else if (hour >= 0 && hour <= 6) { baseQuality -= 20; feeds.push({t:'danger', m:'Ölü Saat: İçerik etkileşim alamadan alt sıralara düşebilir (-20).'}); }

            // Okunabilirlik (Dwell Time)
            const lineCount = text.split('\n').length;
            if(lineCount > 3) { baseQuality += 10; dwellTime += 15; feeds.push({t:'success', m:'Okunabilirlik: Satır boşlukları durma süresini artırır (+10).'}); }

            // Otorite Katkısı (Düşük Etki - Sadece Güven İçin)
            if(accType === 1.8) baseQuality += 8; 
            if(accType === 2.5) baseQuality += 12;
            if(accType === 0.5) baseQuality -= 30;

            // CEZALAR (Yüzdesel / Çarpan Bazlı) - En önemli kısım
            if(text.includes('http')) {
                penalties *= 0.4; // %60 düşüş
                spamRisk += 40;
                feeds.push({t:'danger', m:'Dış Bağlantı Cezası: X, kullanıcıyı dışarı atan tweetleri %60 kısıtlar.'});
            }

            const baitKeywords = ['takip','rt','beğen','fav','çekiliş','dm','takibe'];
            if(baitKeywords.some(b => text.toLowerCase().includes(b))) {
                penalties *= 0.5; // %50 düşüş
                spamRisk += 50;
                feeds.push({t:'danger', m:'Etkileşim Yemi: Yasaklı kelimeler tespit edildi (%50 Ceza).'});
            }

            // Cluster Çarpanı
            penalties *= cluster;
        }

        // 3. FİNAL HESAPLAMA
        // Formül: (Baz Kalite * Cezalar)
        let finalScore = Math.floor(baseQuality * penalties);
        finalScore = Math.min(100, Math.max(0, finalScore));

        // Erişim (Reach) Hesaplama (Hesap otoritesinin asıl çalıştığı yer)
        let reachValue = (finalScore * accType * 1500); 
        if (finalScore < 20) reachValue = finalScore * 100; // Kalitesiz içerik otorite olsa da yayılmaz.

        // UI GÜNCELLEME
        const sEl = document.getElementById('score');
        sEl.textContent = finalScore;
        
        // Renk skalası
        if(finalScore > 75) sEl.style.color = 'var(--success)';
        else if(finalScore > 40) sEl.style.color = 'var(--warning)';
        else sEl.style.color = 'var(--danger)';
        
        document.getElementById('rank').textContent = finalScore > 75 ? 'VİRAL POTANSİYEL' : (finalScore > 40 ? 'DENGELİ ERİŞİM' : 'ZAYIF GÖRÜNÜRLÜK');
        document.getElementById('mReach').textContent = finalScore > 0 ? Math.floor(reachValue).toLocaleString() : "0";
        document.getElementById('mTrust').textContent = accType + "x";
        document.getElementById('mDwell').textContent = dwellTime + 'sn';
        document.getElementById('mSpam').textContent = '%' + spamRisk;

        feedBox.innerHTML = '';
        feeds.forEach(f => {
            const div = document.createElement('div');
            div.className = `f-item ${f.t}`;
            div.textContent = f.m;
            feedBox.appendChild(div);
        });
    }
</script>

</body>
</html>